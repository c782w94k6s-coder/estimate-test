<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>健診＋予防薬 見積もり</title>
<style>
  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont;
    max-width: 600px;
    margin: auto;
    padding: 20px;
  }
  select, input, button {
    width: 100%;
    padding: 8px;
    margin: 6px 0;
    font-size: 16px;
  }
  .result {
    background: #f3f3f3;
    padding: 15px;
    border-radius: 8px;
    margin-top: 15px;
  }
</style>
</head>
<body>

<h2>健診＋予防薬 見積もり</h2>

<label>動物</label>
<select id="animal">
  <option value="">選択してください</option>
  <option value="dog">犬</option>
  <option value="cat">猫</option>
</select>

<label>体重（kg）</label>
<input type="number" id="weight" step="0.1">

<label>健診コース</label>
<select id="checkup">
  <option value="light">ライト</option>
  <option value="standard">スタンダード</option>
  <option value="premium">プレミアム</option>
</select>

<div id="dog-meds" style="display:none;">
  <p><strong>予防薬（犬）</strong></p>
  <p>フィラリア：イベルメック</p>
  <p>ノミ・マダニ：エフィプロデュオ</p>
</div>

<div id="cat-meds" style="display:none;">
  <p><strong>予防薬（猫）</strong></p>
  <p>レボリューションプラス</p>
</div>

<label>投与月数</label>
<select id="months">
  <option value="8">8ヶ月</option>
  <option value="12">12ヶ月</option>
</select>

<button onclick="calc()">見積もり計算</button>

<div class="result" id="result"></div>

<script>
// =======================
// ★ 仮単価（ここだけ後で差し替え）
// =======================
const medicinePrice = {
  dog: {
    filaria: [
      { max: 5.6, price: 1000 },
      { max: 11.3, price: 1300 },
      { max: 22.6, price: 1800 },
      { max: 45.3, price: 2200 }
    ],
    flea: [
      { max: 10, price: 1400 },
      { max: 20, price: 1700 },
      { max: 40, price: 1900 }
    ]
  },
  cat: {
    combo: [
      { max: 2.5, price: 1700 },
      { max: 5, price: 1800 },
      { max: 10, price: 1900 }
    ]
  }
};

const checkupFee = {
  light: 15000,
  standard: 20000,
  premium: 35000
};

const animalEl = document.getElementById("animal");
const dogMeds = document.getElementById("dog-meds");
const catMeds = document.getElementById("cat-meds");

animalEl.addEventListener("change", () => {
  dogMeds.style.display = animalEl.value === "dog" ? "block" : "none";
  catMeds.style.display = animalEl.value === "cat" ? "block" : "none";
});

function getPrice(list, weight) {
  return list.find(p => weight <= p.max)?.price;
}

function calc() {
  const animal = animalEl.value;
  const weight = Number(document.getElementById("weight").value);
  const months = Number(document.getElementById("months").value);
  const checkup = document.getElementById("checkup").value;

  if (!animal || !weight) {
    alert("動物と体重を入力してください");
    return;
  }

  let medTotal = 0;
  let prices = [];

  if (animal === "dog") {
    const f = getPrice(medicinePrice.dog.filaria, weight);
    const n = getPrice(medicinePrice.dog.flea, weight);
    if (!f || !n) {
      alert("該当する体重区分がありません");
      return;
    }
    prices = [f, n];
    medTotal = (f + n) * months;
  } else {
    const c = getPrice(medicinePrice.cat.combo, weight);
    if (!c) {
      alert("該当する体重区分がありません");
      return;
    }
    prices = [c];
    medTotal = c * months;
  }

  // 割引個数
  const discountCount = months === 12 ? 2 : 1;
  const discount = Math.max(...prices) * discountCount;

  const total = checkupFee[checkup] + medTotal - discount;

  document.getElementById("result").innerHTML = `
    <p>健診料金：¥${checkupFee[checkup].toLocaleString()}</p>
    <p>予防薬合計：¥${medTotal.toLocaleString()}</p>
    <p>割引：${discountCount}個分</p>
    <hr>
    <strong>合計：¥${total.toLocaleString()}</strong>
  `;
}
</script>

</body>
</html>