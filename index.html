<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>かもがわ年間パックお見積り</title>

<style>
:root{
  --main-green:#0b6b3a;
  --sub-green:#e6f2ec;
  --border-green:#9ccbb6;
}
body{
  font-family:sans-serif;
  max-width:720px;
  margin:20px auto;
}
.wrapper{
  border:2px solid var(--border-green);
  border-radius:10px;
  padding:20px;
}
h2{
  background:var(--main-green);
  color:#fff;
  padding:12px;
  border-radius:6px;
  text-align:center;
}
label{
  font-weight:bold;
  display:block;
  margin-top:16px;
}
select,input{
  width:100%;
  padding:6px;
  margin-top:6px;
}
.small{font-size:12px;color:#555;}
.hidden{display:none;}
.box{
  border:1px solid #ccc;
  padding:10px;
  margin-top:10px;
}
button{
  margin-top:20px;
  width:100%;
  padding:12px;
  font-size:16px;
}
#result{
  margin-top:20px;
  background:var(--sub-green);
  padding:14px;
  border-radius:8px;
  font-size:18px;
  font-weight:bold;
}
</style>
</head>

<body>
<div class="wrapper">
<h2>かもがわ年間パックお見積り</h2>

<label>動物</label>
<select id="animal">
  <option value="">選択してください</option>
  <option value="dog">犬</option>
  <option value="cat">猫</option>
</select>

<label>体重（kg）</label>
<input type="number" id="weight" step="0.1">

<label>健診コース</label>
<select id="course">
  <option value="">選択してください</option>
  <option value="light">ライト</option>
  <option value="standard">スタンダード</option>
  <option value="premium">プレミアム</option>
  <option value="CT">CTコース</option>
</select>
  
<div id="ct-note" class="small hidden" style="color:#b00000;">
※CTコースは別途 読影料・静脈留置代・点滴代がかかります<br>
※体重・体格・性格により全身麻酔または鎮静が必要な場合があります
</div>

<label>予防期間</label>
<select id="plan"></select>

  <div id="method-area" class="box hidden">
  <label>予防方法</label>
  <input type="radio" name="method" value="combo" checked> 1種類で予防（総合）
  <br>
  <input type="radio" name="method" value="separate"> 2種類で予防（別々）
</div>

<!-- 犬Bプラン パターン -->
<div id="dog-pattern" class="box hidden">
  <label>Bプランの予防方法</label>
  <input type="radio" name="bpattern" value="p1" checked>
  パターン①：フィラリア8ヶ月＋ノミダニ12ヶ月<br><br>
  <input type="radio" name="bpattern" value="p2">
  パターン②：総合8ヶ月＋ノミダニ4ヶ月
</div>

<!-- 犬 総合 -->
<div id="combo-area" class="box hidden">
  <label>総合予防薬</label>
  <select id="combo-med">
    <option value="cred">クレデリオプラス</option>
    <option value="nexsp">ネクスガードスペクトラ</option>
  </select>
</div>

<!-- 犬 別々 -->
<div id="separate-area" class="box hidden">
  <label>ノミダニ予防薬</label>
  <select id="flea-med">
    <option value="effipro">エフィプロデュオ</option>
    <option value="nex">ネクスガード</option>
  </select>

  <label style="margin-top:10px;">フィラリア予防薬</label>
  <select id="heart-med">
    <option value="iver">イベルメック</option>
  </select>
</div>

<!-- 猫 -->
<div id="cat-area" class="box hidden">
  <label>猫の予防薬</label>
  <select id="cat-med">
    <option value="rev">レボリューションプラス</option>
    <option value="catcombo">ネクスガードキャットコンボ</option>
  </select>
</div>

<button on‍click="calc()">見積もり計算</button>

<div id="result"></div>
<div id="detail" class="small"></div>
</div>

<script>
// ===== 単価 =====
const prices={
  cred:[[2.8,2200],[5.5,2300],[11,2800],[22,3500],[45,4000]],
  nexsp:[[3.6,3000],[7.5,3400],[15,3800],[30,4400],[60,4700]],
  effipro:[[10,1400],[20,1700],[40,1900]],
  nex:[[4.5,1600],[11,1800],[27,2000],[55,2300]],
  iver:[[5.6,1000],[11.3,1300],[22.6,1800],[45.3,2200]],
  rev:[[2.5,1700],[5,1800],[10,1900]],
  catcombo:[[2.5,1100],[7.5,1200]]
};

function getPrice(list,w){
  for(const i of list){
    if(w<=i[0]) return i[1];
  }
  return 0;
}

// ===== 健診 =====
function checkup(course,w){
  if(course==="light") return 7700;
  if(course==="standard"){
    if(w<=10) return 18700;
    if(w<=20) return 20900;
    if(w<=40) return 23100;
    return 25300;
  }
  if(course==="premium"){
    if(w<=10) return 36300;
    if(w<=20) return 38500;
    if(w<=40) return 44000;
    return 49500;
  }
   return 0;
}

// ===== UI制御 =====
animal.onchange=updateUI;
plan.onchange=updateUI;
planSel.onchange=updateUI;

function updateUI(){
  document.getElementById("ct-note")
  .classList.toggle("hidden", course.value !== "ct");
  plan.innerHTML="";
  function addPlanOptions(list){
  list.forEach(p=>{
    const o=document.createElement("option");
    o.value=p[0];
    o.textContent=p[1];
    planSel.appendChild(o);
  });
}
  document.querySelectorAll(".box").forEach(b=>b.classList.add("hidden"));

// 犬でA or Cのときだけ表示
if(animal.value==="dog" && (planSel.value==="A" || planSel.value==="C")){
  document.getElementById("method-area").classList.remove("hidden");

  const method =
    document.querySelector("input[name='method']:checked").value;

  if(method==="combo"){
    combo-area.classList.remove("hidden");
  }else{
    separate-area.classList.remove("hidden");
  }
}
  
  if(animal.value==="dog"){
  [
    ["A","フィラリア8ヶ月／ノミダニ8ヶ月"],
    ["B","フィラリア8ヶ月／ノミダニ12ヶ月"],
    ["C","フィラリア12ヶ月／ノミダニ12ヶ月"]
  ].forEach(p=>{
    const o=document.createElement("option");
    o.value=p[0];
    o.textContent=`${p[0]}：${p[1]}`;
    planSel.appendChild(o);
  });
}

if(animal.value==="cat"){
  [
    ["A","ノミダニ・フィラリア8ヶ月"],
    ["B","ノミダニ・フィラリア12ヶ月"]
  ].forEach(p=>{
    const o=document.createElement("option");
    o.value=p[0];
    o.textContent=`${p[0]}：${p[1]}`;
    planSel.appendChild(o);
  });
}
    document.getElementById("cat-area").classList.remove("hidden");
  }

  if(animal.value==="dog"){
    if(plan.value==="A" || plan.value==="C"){
      document.getElementById("combo-area").classList.remove("hidden");
      document.getElementById("separate-area").classList.remove("hidden");
    }
    if(plan.value==="B"){
      document.getElementById("dog-pattern").classList.remove("hidden");
      const p=document.querySelector("input[name='bpattern']:checked").value;
      if(p==="p1"){
        document.getElementById("separate-area").classList.remove("hidden");
      }else{
        document.getElementById("combo-area").classList.remove("hidden");
        document.getElementById("separate-area").classList.remove("hidden");
      }
    }
  }
}

// ===== 計算 =====
function calc(){
  if(!animal.value || !weight.value || !course.value){
    alert("未選択の項目があります");
    return;
  }

  const w=Number(weight.value);
  let total=checkup(course.value,w);
  let detail=[`健診：${total.toLocaleString()}円`];

if(animal.value==="dog"){
  const fleaPrice = getPrice(prices[document.getElementById("flea-med").value], w);
  const heartPrice = getPrice(prices.iver, w);
  const comboPrice = getPrice(prices[document.getElementById("combo-med").value], w);

  if(planSel.value==="A"){
    total += heartPrice * 7;
    total += fleaPrice * 7;
    detail.push("犬A：フィラリア8ヶ月＋ノミダニ8ヶ月（各1個分割引）");
  }
    if(plan.value==="B"){
      const pat=document.querySelector("input[name='bpattern']:checked").value;
      if(pat==="p1"){
        total+=fleaP*10 + heartP*7;
        detail.push("犬B①：フィラリア8＋ノミダニ12");
      }else{
        total+=comboP*7 + fleaP*3;
        detail.push("犬B②：総合8＋ノミダニ4");
      }
    }
    if(planSel.value==="C"){
    total += heartPrice * 10;
    total += fleaPrice * 10;
    detail.push("犬C：フィラリア12ヶ月＋ノミダニ12ヶ月（各2個分割引）");
    }
  }

  if(animal.value==="cat"){
    const p=getPrice(prices[cat-med.value],w);
    total+= p * (plan.value==="A"?7:10);
    detail.push("猫：年間まとめ割引");
  }

  result.textContent=`合計（税抜）：${total.toLocaleString()}円`;
  detail.innerHTML=detail.join("<br>");
}

updateUI();
</script>
</body>
</html>
