<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‹ã‚‚ãŒã‚å¹´é–“ãƒ‘ãƒƒã‚¯ãŠè¦‹ç©ã‚Š</title>

<style>
:root{
  --main-green:#0b6b3a;
  --sub-green:#e6f2ec;
  --border-green:#9ccbb6;
}
body{
  font-family:sans-serif;
  max-width:720px;
  margin:20px auto;
}
.wrapper{
  border:2px solid var(--border-green);
  border-radius:10px;
  padding:20px;
}
h2{
  background:var(--main-green);
  color:#fff;
  padding:12px;
  border-radius:6px;
  text-align:center;
}
label{
  font-weight:bold;
  display:block;
  margin-top:16px;
}
select,input{
  width:100%;
  padding:6px;
  margin-top:6px;
  font-size:16px;
}
.small{font-size:12px;color:#555;}
.hidden{display:none;}
.box{
  border:1px solid #ccc;
  padding:10px;
  margin-top:10px;
}
button{
  margin-top:20px;
  width:100%;
  padding:12px;
  font-size:16px;
}
#result{
  margin-top:20px;
  background:var(--sub-green);
  padding:14px;
  border-radius:8px;
  font-size:18px;
  font-weight:bold;
}
  .pattern-card{
  display:block;
  border:1px solid #ccc;
  padding:10px;
  margin-top:10px;
  border-radius:6px;
  cursor:pointer;
}
.pattern-card:hover{
  background:#f5f5f5;
}
.pattern-card input{
  margin-right:6px;
}

</style>
</head>

<body>
  <div style="text-aling:center; margin:20px 0;">
  <img src="logo.png" style="max-width:200px;">
</div>
<div class="wrapper">
<h2>ã‹ã‚‚ãŒã‚å¹´é–“ãƒ‘ãƒƒã‚¯ãŠè¦‹ç©ã‚Š</h2>

<label>å‹•ç‰©</label>
<select id="animal">
  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
  <option value="dog">çŠ¬</option>
  <option value="cat">çŒ«</option>
</select>

<label>ä½“é‡ï¼ˆkgï¼‰</label>
<input type="number" id="weight" step="0.1">

<label>å¥è¨ºã‚³ãƒ¼ã‚¹</label>
<select id="course">
  <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
  <option value="light">ãƒ©ã‚¤ãƒˆ</option>
  <option value="standard">ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰</option>
  <option value="premium">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ </option>
  <option value="ct">CTã‚³ãƒ¼ã‚¹</option>
</select>
  
<div id="ct-note" class="small hidden" style="color:#b00000;">
â€»CTã‚³ãƒ¼ã‚¹ã¯åˆ¥é€” èª­å½±æ–™ãƒ»é™è„ˆç•™ç½®ä»£ãƒ»ç‚¹æ»´ä»£ãŒã‹ã‹ã‚Šã¾ã™<br>
â€»ä½“é‡ãƒ»ä½“æ ¼ãƒ»æ€§æ ¼ã«ã‚ˆã‚Šå…¨èº«éº»é…”ã¾ãŸã¯é®é™ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚Šã¾ã™
</div>

<label>äºˆé˜²è–¬ãƒ—ãƒ©ãƒ³</label>
<select id="planSel"></select>

  <div id="method-area" class="box hidden">
  <label>äºˆé˜²æ–¹æ³•</label>
  <input type="radio" name="method" value="combo" checked> 1ç¨®é¡ã§ã¾ã¨ã‚ã¦äºˆé˜²ã™ã‚‹
  <br>
  <input type="radio" name="method" value="separate"> 2ç¨®é¡ã§äºˆé˜²ã™ã‚‹
</div>

<!-- çŠ¬Bãƒ—ãƒ©ãƒ³ ãƒ‘ã‚¿ãƒ¼ãƒ³ -->
<div id="dog-pattern" class="box hidden">
  <label>Bãƒ—ãƒ©ãƒ³ã®äºˆé˜²æ–¹æ³•</label>

  <label class="pattern-card">
    <input type="radio" name="bpattern" value="p1" checked>
    <strong>ãƒ‘ã‚¿ãƒ¼ãƒ³â‘ ï¼ˆãƒ•ã‚£ãƒ©ãƒªã‚¢+ãƒãƒŸãƒ€ãƒ‹ï¼‰</strong><br>
    ãƒ•ã‚£ãƒ©ãƒªã‚¢äºˆé˜²è–¬8ãƒ¶æœˆ<br>
    ãƒãƒŸãƒ€ãƒ‹äºˆé˜²è–¬12ãƒ¶æœˆ<br>
    <span class="small">â†’ ç‹é“ãƒ‘ã‚¿ãƒ¼ãƒ³</span>
  </label>

  <label class="pattern-card">
    <input type="radio" name="bpattern" value="p2">
    <strong>ãƒ‘ã‚¿ãƒ¼ãƒ³â‘¡ï¼ˆç·åˆï¼‹ãƒãƒŸãƒ€ãƒ‹ï¼‰</strong><br>
    ç·åˆäºˆé˜²è–¬8ãƒ¶æœˆ<br>
    ãƒãƒŸãƒ€ãƒ‹äºˆé˜²è–¬4ãƒ¶æœˆè¿½åŠ <br>
    <span class="small">â†’ æŠ•è–¬å›æ•°ã‚’æ¸›ã‚‰ã—ãŸã„æ–¹å‘ã‘</span>
  </label>
</div>

<!-- çŠ¬ ç·åˆ -->
<div id="combo-area" class="box hidden">
  <label>ç·åˆäºˆé˜²è–¬</label>
  <select id="combo-med">
    <option value="cred">ã‚¯ãƒ¬ãƒ‡ãƒªã‚ªãƒ—ãƒ©ã‚¹(ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆã‚¿ã‚¤ãƒ—)</option>
    <option value="nexsp">ãƒã‚¯ã‚¹ã‚¬ãƒ¼ãƒ‰ã‚¹ãƒšã‚¯ãƒˆãƒ©(ã‚­ãƒ¥ãƒ¼ãƒ–ã‚¿ã‚¤ãƒ—)</option>
  </select>
</div>

<!-- çŠ¬ åˆ¥ã€… -->
<div id="separate-area" class="box hidden">
  <label>ãƒãƒŸãƒ€ãƒ‹äºˆé˜²è–¬</label>
  <select id="flea-med">
    <option value="effipro">ã‚¨ãƒ•ã‚£ãƒ—ãƒ­ãƒ‡ãƒ¥ã‚ª(ã‚¹ãƒãƒƒãƒˆã‚¿ã‚¤ãƒ—)</option>
    <option value="nex">ãƒã‚¯ã‚¹ã‚¬ãƒ¼ãƒ‰(ã‚­ãƒ¥ãƒ¼ãƒ–ã‚¿ã‚¤ãƒ—)</option>
  </select>

 <div id="heart-area">
  <label style="margin-top:10px;">ãƒ•ã‚£ãƒ©ãƒªã‚¢äºˆé˜²è–¬</label>
  <select id="heart-med">
    <option value="iver">ã‚¤ãƒ™ãƒ«ãƒ¡ãƒƒã‚¯(ãŠã‚„ã¤ã‚¿ã‚¤ãƒ—)</option>
  </select>
</div>
</div>
  
<!-- çŒ« -->
<div id="cat-area" class="box hidden">
  <label>çŒ«ã®äºˆé˜²è–¬</label>
  <select id="cat-med">
    <option value="rev">ãƒ¬ãƒœãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ã‚¹(ã‚¹ãƒãƒƒãƒˆã‚¿ã‚¤ãƒ—)</option>
    <option value="catcombo">ãƒã‚¯ã‚¹ã‚¬ãƒ¼ãƒ‰ã‚­ãƒ£ãƒƒãƒˆã‚³ãƒ³ãƒœ(ã‚¹ãƒãƒƒãƒˆã‚¿ã‚¤ãƒ—)</option>
  </select>
</div>

<button onclick="calc()">è¦‹ç©ã‚‚ã‚Šè¨ˆç®—</button>

<div id="result"></div>
<div id="detail" class="small"></div>
</div>

<script>
/* ===== DOM ===== */
const animalÂ Â Â = document.getElementById("animal");
const planSel = document.getElementById("planSel");
const courseÂ Â Â = document.getElementById("course");
const weightÂ Â Â = document.getElementById("weight");
const resultÂ Â Â = document.getElementById("result");
const detailEl = document.getElementById("detail");

/* ===== å˜ä¾¡ ===== */
const prices={
Â Â effipro:[[10,1400],[20,1700],[40,1900]],
Â Â nex:[[4.5,1600],[11,1800],[27,2000],[55,2300]],
Â Â iver:[[5.6,1000],[11.3,1300],[22.6,1800],[45.3,2200]],
Â Â cred:[[2.8,2200],[5.5,2300],[11,2800],[22,3500],[45,4000]],
Â Â nexsp:[[3.6,3000],[7.5,3400],[15,3800],[30,4400],[60,4700]],
Â Â rev:[[2.5,1700],[5,1800],[10,1900]],
Â Â catcombo:[[2.5,1100],[7.5,1200]]
};
function getPrice(table, weight){
  for(const row of table){
    if(weight <= row.max){
      return row.price;
    }
  }
  return null;  
}
/* ===== å¥è¨º ===== */
function checkup(course,w){
Â Â if(course==="light") return 7700;
Â Â if(course==="standard"){
Â Â Â Â if(w<=10) return 18700;
Â Â Â Â if(w<=20) return 20900;
Â Â Â Â if(w<=40) return 23100;
Â Â Â Â return 25300;
Â Â }
Â Â if(course==="premium"){
Â Â Â Â if(w<=10) return 36300;
Â Â Â Â if(w<=20) return 38500;
Â Â Â Â if(w<=40) return 44000;
Â Â Â Â return 49500;
Â Â }
  if(course==="ct"){
Â Â if(w <= 10) return 41700;

Â Â // 10kgè¶…ãˆãŸåˆ†ã‚’10kgå˜ä½ã§åŠ ç®—
Â Â const extra = Math.ceil((w - 10) / 10) * 10000;
Â Â return 41700 + extra;
}
Â Â return 0;
}

/* ===== UIåˆ¶å¾¡ ===== */  
  function resetPrevention(){
  // äºˆé˜²æ–¹æ³•ãƒªã‚»ãƒƒãƒˆï¼ˆ1ç¨®é¡ã«æˆ»ã™ï¼‰
  document.querySelector("input[name='method'][value='combo']").checked = true;
  // Bãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚â‘ ã«æˆ»ã™
  document.querySelector("input[name='bpattern'][value='p1']").checked = true;
}
  animal.onchange = function(){
   resetPrevention();
    createPlans();
  updateUI();
};
  course.onchange=updateUI;

  planSel.onchange=function(){
    resetPrevention();
    updateUI();
  };
  document.querySelectorAll("input[name='method']").forEach(r=>{
  r.onchange = updateUI;
});
  document.querySelectorAll("input[name='bpattern']").forEach(r=>{
  r.onchange = updateUI;
});
function createPlans(){
  planSel.innerHTML = "";
// äºˆé˜²æœŸé–“
Â Â if(animal.value==="dog"){
Â Â Â Â [
Â Â Â Â Â Â ["A","ãƒ•ã‚£ãƒ©ãƒªã‚¢8ãƒ¶æœˆï¼‹ãƒãƒŸãƒ€ãƒ‹8ãƒ¶æœˆ"],
Â Â Â Â Â Â ["B","ãƒ•ã‚£ãƒ©ãƒªã‚¢8ãƒ¶æœˆï¼‹ãƒãƒŸãƒ€ãƒ‹12ãƒ¶æœˆ"],
Â Â Â Â Â Â ["C","ãƒ•ã‚£ãƒ©ãƒªã‚¢12ãƒ¶æœˆï¼‹ãƒãƒŸãƒ€ãƒ‹12ãƒ¶æœˆ"]
Â Â Â Â ].forEach(p=>{
Â Â Â Â Â Â const o=document.createElement("option");
Â Â Â Â Â Â o.value=p[0];
Â Â Â Â Â Â o.textContent=`ã¾ã¨ã‚${p[0]}ï¼š${p[1]}`;
Â Â Â Â Â Â planSel.appendChild(o);
Â Â Â Â });
Â Â }

Â Â if(animal.value==="cat"){
Â Â Â Â [
Â Â Â Â Â Â ["A","8ãƒ¶æœˆ"],
Â Â Â Â Â Â ["B","12ãƒ¶æœˆ"]
Â Â Â Â ].forEach(p=>{
Â Â Â Â Â Â const o=document.createElement("option");
Â Â Â Â Â Â o.value=p[0];
Â Â Â Â Â Â o.textContent=`ã¾ã¨ã‚${p[0]}ï¼š${p[1]}`;
Â Â Â Â Â Â planSel.appendChild(o);
Â Â Â Â });
  }
}
function updateUI(){
  document.querySelectorAll(".box").forEach(b=>b.classList.add("hidden"));

  // CTæ³¨æ„
  document.getElementById("ct-note")
    .classList.toggle("hidden", course.value!=="ct");

  // çŒ«
  if(animal.value==="cat"){
    document.getElementById("cat-area").classList.remove("hidden");
  }

  // çŠ¬
  if(animal.value==="dog"){

    if(planSel.value==="A" || planSel.value==="C"){
      document.getElementById("method-area").classList.remove("hidden");

      const m=document.querySelector("input[name='method']:checked").value;

      document.getElementById(
        m==="combo" ? "combo-area" : "separate-area"
      ).classList.remove("hidden");
    }

    if(planSel.value==="B"){
      document.getElementById("dog-pattern").classList.remove("hidden");

      const pat=document.querySelector("input[name='bpattern']:checked").value;

      if(pat==="p1"){
        document.getElementById("separate-area").classList.remove("hidden");
        document.getElementById("heart-area").classList.remove("hidden");
      }else{
        document.getElementById("combo-area").classList.remove("hidden");
        document.getElementById("separate-area").classList.remove("hidden");
        document.getElementById("heart-area").classList.add("hidden");
      }
    }
  }
}
/* ===== è¨ˆç®— ===== */
function calc(){
  const w = Number(weight.value);

  if(!animal.value || !course.value || !w){
    alert("æœªé¸æŠãŒã‚ã‚Šã¾ã™");
    return;
  }

  function showConsultMessage(){
    result.textContent = "ğŸ¾ ã“ã®ä½“é‡ã§ã¯å¯¾å¿œã§ããªã„ãŠè–¬ãŒã‚ã‚Šã¾ã™ã€‚ã‚¹ã‚¿ãƒƒãƒ•ã¾ã§ã”ç›¸è«‡ãã ã•ã„ã€‚";
    detailEl.innerHTML = "";
  }

  let courseName = "";
  if(course.value==="light") courseName = "ãƒ©ã‚¤ãƒˆã‚³ãƒ¼ã‚¹";
  if(course.value==="standard") courseName = "ã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã‚³ãƒ¼ã‚¹";
  if(course.value==="premium") courseName = "ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚³ãƒ¼ã‚¹";
  if(course.value==="ct") courseName = "CTã‚³ãƒ¼ã‚¹";

  let planName = "";
  let total = checkup(course.value,w);
  const checkupPrice = total;

  let preventionTotal = 0;
  let discountText = "";

  /* ===== çŠ¬ ===== */
  if(animal.value==="dog"){

    planName = "ã¾ã¨ã‚" + planSel.value;

    const flea  = getPrice(prices[document.getElementById("flea-med").value], w);
    const heart = getPrice(prices[document.getElementById("heart-med").value], w);
    const combo = getPrice(prices[document.getElementById("combo-med").value], w);

    // nullãƒã‚§ãƒƒã‚¯
    if(
      (flea === null && document.getElementById("flea-med")) ||
      (heart === null && document.getElementById("heart-med")) ||
      (combo === null && document.getElementById("combo-med"))
    ){
      showConsultMessage();
      return;
    }

    if(planSel.value==="A"){
      preventionTotal = flea*7 + heart*7;
      discountText = "âœ¨äºˆé˜²è–¬2å€‹åˆ†ãŠå¾—ï¼";
    }

    if(planSel.value==="B"){
      const pat = document.querySelector("input[name='bpattern']:checked").value;

      if(pat==="p1"){
        preventionTotal = heart*7 + flea*10;
        discountText = "âœ¨äºˆé˜²è–¬3å€‹åˆ†ãŠå¾—ï¼";
      }else{
        preventionTotal = combo*7 + flea*3;
        discountText = "âœ¨äºˆé˜²è–¬2å€‹åˆ†ãŠå¾—ï¼";
      }
    }

    if(planSel.value==="C"){
      preventionTotal = flea*10 + heart*10;
      discountText = "âœ¨äºˆé˜²è–¬4å€‹åˆ†ãŠå¾—ï¼";
    }
  }

  /* ===== çŒ« ===== */
  if(animal.value==="cat"){

    planName = "çŒ«ã¾ã¨ã‚" + planSel.value;

    const catMed = document.getElementById("cat-med").value;
    const p = getPrice(prices[catMed], w);

    if(p === null){
      showConsultMessage();
      return;
    }

    if(planSel.value==="A"){
      preventionTotal = p * 7;
      discountText = "âœ¨äºˆé˜²è–¬1å€‹åˆ†ãŠå¾—ï¼";
    }

    if(planSel.value==="B"){
      preventionTotal = p * 10;
      discountText = "âœ¨äºˆé˜²è–¬2å€‹åˆ†ãŠå¾—ï¼";
    }
  }

  total += preventionTotal;

  result.textContent =
    `åˆè¨ˆé‡‘é¡ï¼ˆç¨æŠœï¼‰ï¼š${total.toLocaleString()}å††`;

  detailEl.innerHTML = `
ã€å†…è¨³ã€‘<br>
${courseName}ï¼š${checkup(course.value,w).toLocaleString()}å††<br>
${planName}ï¼š${preventionTotal.toLocaleString()}å††<br><br>
<strong style="color:#0b6b3a;">${discountText}</strong>
`;
}
createPlans();
updateUI();
</script>
</body>
</html>
