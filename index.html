<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>健診＋予防薬 見積もり</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    select, input, button {
      width: 100%;
      padding: 8px;
      margin: 8px 0;
      font-size: 16px;
    }
    .result {
      margin-top: 20px;
      padding: 15px;
      background: #f3f3f3;
      border-radius: 8px;
    }
  </style>
</head>
<body>

<h2>健診＋予防薬 見積もり</h2>

<label>動物種</label>
<select id="animal">
  <option value="">選択してください</option>
  <option value="dog">犬</option>
  <option value="cat">猫</option>
</select>

<label>体重（kg）</label>
<input type="number" id="weight" step="0.1">

<label>健診コース</label>
<select id="checkup">
  <option value="">選択なし</option>
  <option value="light">ライト（予防薬5%OFF）</option>
  <option value="standard">スタンダード（予防薬10%OFF）</option>
  <option value="premium">プレミアム（予防薬15%OFF）</option>
</select>

<label>予防薬カテゴリ</label>
<select id="category"></select>

<label>予防薬</label>
<select id="medicine"></select>

<button onclick="calculate()">見積もり計算</button>

<div class="result" id="result"></div>

<script>
const data = {
  dog: {
    "総合予防薬": {
      "クレデリオプラス": [
        { max: 2.8, price: 2200 },
        { max: 5.5, price: 2300 },
        { max: 11, price: 2800 },
        { max: 22, price: 3500 },
        { max: 45, price: 4000 }
      ],
      "ネクスガードスペクトラ": [
        { max: 3.6, price: 3000 },
        { max: 7.5, price: 3400 },
        { max: 15, price: 3800 },
        { max: 30, price: 4400 },
        { max: 60, price: 4700 }
      ]
    },
    "フィラリア予防薬": {
      "イベルメック": [
        { max: 5.6, price: 1000 },
        { max: 11.3, price: 1300 },
        { max: 22.6, price: 1800 },
        { max: 45.3, price: 2200 }
      ]
    },
    "ノミ・マダニ予防薬": {
      "ネクスガード": [
        { max: 4.5, price: 1600 },
        { max: 11, price: 1800 },
        { max: 27, price: 2000 },
        { max: 55, price: 2300 }
      ],
      "エフィプロデュオ": [
        { max: 10, price: 1400 },
        { max: 20, price: 1700 },
        { max: 40, price: 1900 }
      ]
    },
    "フィラリア・ノミ予防薬": {
      "レボリューション": [
        { max: 2.5, price: 1700 },
        { max: 5, price: 1800 },
        { max: 10, price: 2000 },
        { max: 20, price: 2480 },
        { max: 40, price: 2800 }
      ]
    }
  },

  cat: {
    "総合予防薬": {
      "レボリューションプラス": [
        { max: 2.5, price: 1700 },
        { max: 5, price: 1800 },
        { max: 10, price: 1900 }
      ],
      "ブロードライン": [
        { max: 2.5, price: 2000 },
        { max: 7.5, price: 2100 }
      ]
    },
    "フィラリア・ノミ予防薬": {
      "レボリューション": [
        { max: 2.5, price: 1700 },
        { max: 5, price: 1800 },
        { max: 10, price: 1900 }
      ]
    }
  }
};

const discountRate = {
  light: 0.05,
  standard: 0.10,
  premium: 0.15
};

const animalSelect = document.getElementById("animal");
const categorySelect = document.getElementById("category");
const medicineSelect = document.getElementById("medicine");

animalSelect.addEventListener("change", () => {
  categorySelect.innerHTML = "";
  medicineSelect.innerHTML = "";
  const animal = animalSelect.value;
  if (!animal) return;

  Object.keys(data[animal]).forEach(cat => {
    const opt = document.createElement("option");
    opt.value = cat;
    opt.textContent = cat;
    categorySelect.appendChild(opt);
  });
  categorySelect.dispatchEvent(new Event("change"));
});

categorySelect.addEventListener("change", () => {
  medicineSelect.innerHTML = "";
  const animal = animalSelect.value;
  const cat = categorySelect.value;
  if (!animal || !cat) return;

  Object.keys(data[animal][cat]).forEach(med => {
    const opt = document.createElement("option");
    opt.value = med;
    opt.textContent = med;
    medicineSelect.appendChild(opt);
  });
});

function calculate() {
  const animal = animalSelect.value;
  const weight = parseFloat(document.getElementById("weight").value);
  const cat = categorySelect.value;
  const med = medicineSelect.value;
  const checkup = document.getElementById("checkup").value;

  if (!animal || !weight || !cat || !med) {
    alert("すべて選択してください");
    return;
  }

  const list = data[animal][cat][med];
  const item = list.find(i => weight <= i.max);

  if (!item) {
    alert("該当する体重区分がありません");
    return;
  }

  const base = item.price;
  const rate = discountRate[checkup] || 0;
  const discount = Math.round(base * rate);
  const total = base - discount;

  document.getElementById("result").innerHTML = `
    <p>予防薬単価：¥${base.toLocaleString()}</p>
    <p>割引額：−¥${discount.toLocaleString()}</p>
    <p><strong>合計：¥${total.toLocaleString()}</strong></p>
  `;
}
</script>

</body>
</html>